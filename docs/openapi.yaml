openapi: 3.1.0
info:
  title: Order Food Online - OpenAPI 3.1
  version: '1.0.0'
  description: |
    This is an e-commerce API based on the OpenAPI 3.1 specification for ordering food online.
    
    You must use the API key `apitest` provided in the header `api_key` for authenticated requests.

    **Useful links:**
    - [Repository](https://github.com/oolio-group/front-end-cart)
  contact:
    name: API Support
    url: http://example.com/support
    email: support@example.com

servers:
  # Base URL variable from Postman collection: {{localUrl}}
  - url: '{{localUrl}}/api'
    description: Local or Development server

tags:
  - name: product
    description: Operations related to food products.
  - name: order
    description: Operations for creating and managing orders.

paths:
  /product:
    get:
      tags:
        - product
      summary: Retrieve a list of all products
      operationId: listProducts
      security:
        - apiKeyAuth: []
      responses:
        '200':
          description: A successful response returning a list of available products.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Product'
              examples:
                success:
                  value:
                    - productId: "1"
                      name: "Burger"
                      price: 10.0
                      description: "Classic beef patty"
                      inStock: true
        '401':
          description: Unauthorized - Missing or invalid API key.

  /product/{productId}:
    parameters:
      - name: productId
        in: path
        required: true
        schema:
          type: string
        description: The ID of the product to retrieve.
        
    get:
      tags:
        - product
      summary: Get product details by ID
      operationId: getProductById
      security:
        - apiKeyAuth: []
      responses:
        '200':
          description: Successfully retrieved product details.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
              examples:
                success:
                  value:
                    productId: "2"
                    name: "Fries"
                    price: 3.5
                    description: "Crispy salted fries"
                    inStock: true
        '401':
          description: Unauthorized - Missing or invalid API key.
        '404':
          description: Product not found.

  /order:
    post:
      tags:
        - order
      summary: Create a new order
      operationId: createOrder
      security:
        - apiKeyAuth: []
      requestBody:
        description: Order details including coupon code and item list.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderRequest'
            examples:
              validOrder:
                value:
                  couponCode: "SUMMER24"
                  items:
                    - productId: "1"
                      quantity: 1
                    - productId: "2"
                      quantity: 2
      responses:
        '201':
          description: Order successfully created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderConfirmation'
              examples:
                success:
                  value:
                    orderId: "ORD-12345"
                    totalPrice: 17.0
                    status: "Pending"
        '400':
          description: Invalid request body or item quantities.
        '401':
          description: Unauthorized - Missing or invalid API key.

components:
  securitySchemes:
    apiKeyAuth: 
      type: apiKey
      in: header
      name: api_key
      description: API Key authentication required for all operations.

  schemas:
    Product:
      type: object
      description: Details of a single food product.
      properties:
        productId:
          type: string
          description: Unique identifier for the product.
        name:
          type: string
          description: Name of the product.
        price:
          type: number
          format: float
          description: Price of the product.
        description:
          type: string
          description: Short description of the product.
        inStock:
          type: boolean
          description: Availability status of the product.
      required:
        - productId
        - name
        - price
        - inStock

    OrderItem:
      type: object
      description: An item within an order request.
      properties:
        productId:
          type: string
          description: The ID of the product being ordered.
        quantity:
          type: integer
          description: The number of units of this product.
          minimum: 1
      required:
        - productId
        - quantity

    CreateOrderRequest:
      type: object
      description: The request body for creating a new order.
      properties:
        couponCode:
          type: string
          description: Optional coupon code to apply to the order.
        items:
          type: array
          description: List of items to be included in the order.
          items:
            $ref: '#/components/schemas/OrderItem'
      required:
        - items

    OrderConfirmation:
      type: object
      description: Response details after a successful order creation.
      properties:
        orderId:
          type: string
          description: The unique ID assigned to the new order.
        totalPrice:
          type: number
          format: float
          description: The final price of the order after any discounts.
        status:
          type: string
          description: The current status of the order (e.g., Pending, Confirmed).
      required:
        - orderId
        - totalPrice
        - status